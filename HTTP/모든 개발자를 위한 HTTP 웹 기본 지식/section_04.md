# 모든 개발자를 위한 HTTP 웹 기본 지식

## HTTP 프로토콜 - HTTP 기본

1. HTTP API를 만들어보자

    - 리소스 식별이 중요!!

        - ex) 회원 등록, 회원 조회, 회원 수정, 회원 삭제 => 회원이라는 개념 자체가 바로 리소스

        - 회원을 등록하고 수정하고 조회하는 것을 모두 배제

        - 회원이라는 리소스만 식별하면 됨 -> 회원 리소스를 URI에 매핑

    - URI는 리소스만 식별

        - 리소스 : 회원

        - 행위 : 조회, 등록, 삭제 ,변경

        - 행위는 HTTP 메서드를 통해 구분!

2. HTTP 메서드 - GET,POST

    - GET : 리소스 조회

    - POST : 요청 데이터 처리, 주로 등록에 사용

    - GET

        - 리소스 조회

        - 서버에 전달하고 싶은 데이터는 query(쿼리 파라미터, 쿼리 스트링)를 통해서 전달

        - 메시지 바디를 사용해서 데이터를 전달할 수 있지만, 지원하지 않는 곳이 많아서 권장하지 않음

        요청 (HTTP 시작라인과 헤더) -------> 쿼리 스트링에 담긴 값으로 데이터 조회
        데이터 도착 <--------------------- 응답(HTTP 바디에 데이터 담아서 응답)

    - POST

        - 요청 데이터 처리

        - 메시지 바디를 통해 서버로 요청 데이터 전달

        - 서버는 요청 데이터를 처리
            - 메시지 바디를 통해 들어온 데이터를 처리하는 모든 기능을 수행

        - 주로 전달된 데이터로 신규 리소스 등록, 프로세스 처리에 사용

        요청 (HTTP 시작라인과 헤더와 바디) -------> 바디에 담긴 데이터를 처리
        바디에 담은 데이터 돌려받음 <-------------- 응답(바디에 담겨온 데이터 돌려줌)

        * POST 메서드가 의미하는 요청 데이터 처리

            1. 새 리소스 생성 (등록)
                - 서버가 아직 식별하지 않은 새 리소스 생성

            2. 요청 데이터 처리
                - 단순히 데이터를 생성하거나, 변경하는 것을 넘어서 프로세스를 처리해야 하는 경우
                    ex) 주문에서 결제완료 -> 배달시작 -> 배달완료 처럼 단순히 값 변경을 넘어 프로세스의 상태가 변경되는 경우

                - POST의 결과로 새로운 리소스가 생성되지 않을 수도 있음
                
                - ex) POST /orders/{orderId}/start-delivery
                    - 불가피할 경우 URI에 리소스가 아닌 동사형 단어가 옴 => 컨트롤 URI

            3. 다른 메서드로 처리하기 애매한 경우
                - ex) JSON으로 조회 데이터를 넘겨야 하는데, GET 메서드를 사용하기 어려운 경우
                - 애매하면 POST

            * GET 대신 POST를 써도 되지만 캐싱이 불편해짐!

3. HTTP 메서드 - PUT, PATCH, DELETE

    - PUT 

        - 리소스를 대체

            - 리소스가 있으면 완전히 대체

            - 리소스가 없으면 생성

            - 쉽게 말하자면 덮어버림

        - 클라이언트가 리소스를 식별!!

            - 클라이언트가 리소스 위치를 알고 URI 지정 -> POST와의 차이점 (POST는 리소스 위치 모름)

        요청 (HTTP 시작라인과 헤더와 바디) -------> 바디에 담긴 데이터를 처리 (리소스가 이미 있으면 대체)

        * 리소스가 이미 있으면 완전히 대체!!
            -> 기존 데이터가 username, age일 때, PUT으로 데이터를 age만 넘길 경우 서버에서 username 사라짐
      
    - PATCH

        - 리소스 부분 변경

        - 리소스가 이미 있을 경우
            -> 기존 데이터가 username, age일 때, PUT으로 데이터를 age만 넘길 경우 서버에서 username는 그대로 남고 age 값만 덮어씌움

        - PATCH가 안통하는 소수의 서버에서는 POST로 해결

    - DELETE

        - 리소스 제거

4.  HTTP 메서드의 속성

    - 안전
        
        - 호출해도 리소스를 변경하지 않음

        - 안전은 해당 리소스만 고려

        - GET, HEAD, OPTIONS, TRACE 정도만 해당

    - 멱등

        - 한 번 호출하든 두 번 호출하든 100번 호출하든 결과가 같음

        - GET, PUT, DELETE 해당

        - POST는 멱등 x (ex) 두 번 호출하면 같은 결제가 중복 발생)

        - 멱등은 자동 복구 메커니즘에 활용

            - 서버가 TIMEOUT 등으로 정상 응답을 못 주었을 때, 클라이언트가 같은 요청을 다시 해도 되는지의 판단 근거

    - 캐시가능

        - GET, HEAD, POST, PATCH 캐시 가능

        - 실제로는 GET, HEAD 정도만 캐시로 사용
            - POST, PATCH는 바디의 내용까지 캐시 키 값으로 매칭 시켜줘야 하는데 까다로움